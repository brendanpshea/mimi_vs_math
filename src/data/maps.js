/**
 * maps.js — Procedural "fill-and-carve" decoration layouts for each ExploreScene region.
 *
 * Each map is generated by ProceduralMap.generateRegionMap():
 *   1. Fill the walkable area with the region's blocking terrain tile.
 *   2. Clear a 3-tile-radius glade around every key position
 *      (Mimi start, enemies, NPC, boss).
 *   3. Build a minimum spanning tree (Prim's, rooted at Mimi's start)
 *      that connects every key position.
 *   4. Carve a 3-tile-wide L-shaped corridor along every MST edge.
 *
 * WALK_GRIDS[regionId] exposes the exact blocked-tile Set for BFS tests.
 *
 * To verify connectivity:  node test_connectivity.mjs
 */

import { generateRegionMap } from './ProceduralMap.js';
import REGIONS               from './regions/index.js';

const _gen = REGIONS.map(r => generateRegionMap(r));

/** Decoration arrays for ExploreScene._addDecorations() */
const MAPS = _gen.map(g => g.decorations);
export default MAPS;

/** Landmark arrays — one per region, placed as standalone objects */
export const LANDMARKS = _gen.map(g => g.landmarks);

/** Randomized NPC + enemy positions generated alongside the map */
export const POSITIONS = _gen.map(g => ({
  npcTile:          g.npcTile,
  enemySpawns:      g.enemySpawns,
  mimiStart:        g.mimiStart,
  bossTile:         g.bossTile,
  interactiveItems: g.interactiveItems ?? [],
}));

/** Live animated objects (torches, etc.) — placed as sprites, never canvas-baked */
export const ANIMATED_DECORATIONS = _gen.map(g => g.animatedDecorations ?? []);

/**
 * Pre-computed walkability grids — exact blocked-tile Sets for BFS.
 * Each Set<"col,row"> includes border walls + remaining terrain after carving.
 * Use WALK_GRIDS[regionId] in tests for fast, exact connectivity checks.
 */
export const WALK_GRIDS = _gen.map(g => g.blocked);
